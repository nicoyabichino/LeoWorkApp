<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Panel Profe Leo Rodriguez - Control Total</title>
    
    <meta name="theme-color" content="#0b0f1a">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="icon" type="image/png" href="icono.png">
    <link rel="apple-touch-icon" href="icono.png">

    <style>
        :root {
            --bg: #0b0f1a; --card: #161b22; --primary: #3b82f6;
            --success: #238636; --danger: #da3633; --text: #f0f6fc;
            --accent: #8b5cf6; 
            --electric-blue: #00d4ff; 
        }
        
        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: var(--bg); color: var(--text); padding: 10px; padding-bottom: 50px; }
        h1 { font-size: 1.4rem; text-align: center; color: var(--primary); margin: 15px 0; }

        .card { background: var(--card); padding: 15px; border-radius: 12px; margin-bottom: 25px; border: 1px solid #30363d; position: relative; }
        
        .sesion { border-top: 6px solid var(--accent); }
        .dia-label { position: absolute; top: -15px; left: 15px; background: var(--accent); color: white; padding: 2px 12px; border-radius: 4px; font-size: 0.7rem; font-weight: bold; }

        label { display: block; font-size: 0.7rem; color: var(--primary); font-weight: bold; margin-bottom: 4px; text-transform: uppercase; }
        input, select { width: 100%; padding: 12px; margin-bottom: 10px; background: #0d1117; border: 1px solid #30363d; color: white; border-radius: 8px; font-size: 1rem; outline: none; }

        .btn-add-day { background: var(--accent); color: white; width: 100%; padding: 15px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; margin-bottom: 15px; }
        .btn-add-ex { background: #3e4c5a; color: #fff; border: none; padding: 12px; border-radius: 8px; cursor: pointer; width: 100%; font-size: 0.9rem; font-weight: bold; }
        .btn-gen { background: var(--primary); color: white; width: 100%; padding: 18px; font-size: 1.1rem; font-weight: bold; border: none; border-radius: 12px; cursor: pointer; margin-top: 10px; }

        .ex-item { border-left: 3px solid var(--primary); padding: 12px; margin-bottom: 12px; background: #1c2128; border-radius: 0 8px 8px 0; }
        .copy-area { background: #000; color: #22c55e; border: 1px solid var(--success); font-family: monospace; padding: 15px; border-radius: 8px; word-break: break-all; font-size: 0.75rem; margin-top: 10px; }
        
        .footer-sign { text-align: center; color: #888; font-size: 0.7rem; letter-spacing: 3px; margin: 40px 0 20px 0; font-weight: bold; }
        .brand-link { color: var(--electric-blue); text-decoration: none; }

        #temp-copy { position: absolute; left: -9999px; }

        /* Estilo para el banner de instalaci√≥n */
        #install-profe { display: none; width: 100%; padding: 15px; background: white; color: black; border: none; border-radius: 12px; font-weight: 900; margin-bottom: 20px; cursor: pointer; text-transform: uppercase; font-size: 0.8rem; box-shadow: 0 4px 15px rgba(255,255,255,0.1); }
    </style>
</head>
<body>

    <h1>üöÄ Panel Entrenador</h1>

    <button id="install-profe">üì≤ INSTALAR PANEL EN MI CELULAR</button>

    <div class="card">
        <label>Nombre del Alumno</label><input type="text" id="alumno-nombre" placeholder="Ej: Juan P√©rez">
        <label>Semana #</label><input type="text" id="semana-nro" placeholder="Ej: 1">
    </div>

    <div id="rutina-container"></div>

    <button class="btn-add-day" onclick="agregarSesion()">+ AGREGAR OTRO D√çA</button>
    <button class="btn-gen" onclick="generarLink()">GENERAR C√ìDIGO DE RUTINA</button>

    <div id="resultado" style="display:none;" class="card">
        <label>C√≥digo para enviar:</label>
        <div id="linkFinal" class="copy-area"></div>
        <textarea id="temp-copy"></textarea>
        <button onclick="copiarLink()" style="background:#eab308; width:100%; padding:18px; border:none; border-radius:12px; font-weight:bold; margin-top:15px; cursor:pointer; color:black;">üìã COPIAR C√ìDIGO</button>
    </div>

    <div class="footer-sign">
        PROPIEDAD DE <a href="https://www.linkedin.com/in/nicolas-yabichino/" target="_blank" class="brand-link">NICOYABI</a>
    </div>

<script>
    let contadorSesiones = 0;
    let deferredPrompt;

    const DATA_EJERCICIOS = {
        "MOVILIDAD": ["Rotacion de columna", "Movilidad de cadera", "Movilidad de rodilla", "Rotacion de hombros", "Gato malo/bueno"],
        "ABDOMEN / CORE": ["Plancha frontal", "Plancha lateral", "Planchas din√°micas", "Crunch", "Oblicuos", "Bicho muerto", "Bird-dog", "Abs wheel (ruedita)", "Abs sovieticas", "Le√±ador ascendente", "Le√±ador descendente", "Elevacion de piernas"],
        "TREN INF / CUADRICEPS / GEMELOS": ["Sentadilla con barra alta", "Sentadilla con barra baja", "Sentadilla frontal", "Sentadilla en multipower", "Sentadilla hack", "Sentadilla pendular", "Sentadilla goblet", "Sentadilla bulgara (enfoque cuadriceps)", "Prensa bilateral / unilateral", "Sillon cuadriceps bilateral /unilateral", "Estocada hacia adelante", "Subidas al banco (enfoque cuadriceps)", "Gemelos en prensa", "Gemelos en maquina especifica", "Gemelos con mancuernas", "Gemelos con barra"],
        "TREN INF / ISQUIOS / GLUTEOS / ADUCTORES": ["Peso muerto convencional", "Peso muerto rumano", "Peso muerto piernas rigidas", "Peso muerto sumo", "Peso muerto unilateral", "Camilla de isquis bilateral / unilateral", "Aductores en maquina", "Abducciones en maquina", "Patada de gluteo en maquina especifica", "Patada de gluteo en polea", "Hip-trust bilateral / unilateral", "Sentadilla bulgara (enfoque gluteo)", "Subida al banco (enfoque gluteo)", "Abducciones con banda"],
        "PECTORAL": ["Press plano barra / mancuerna / multipower", "Press inclinado barra / mancuenra / multipower", "Press declinado con mancuerna", "Press en polea altura media", "Peck deck", "Apertura con mancuernas", "Flexiones de brazos", "Poleas cruzadas"],
        "DORSALES": ["Dominadas supina", "Dominadas pronacion", "Jalon al pecho supino", "Jalon al pecho prono", "Jalon al pecho agarre cerrado (triangulo)", "Remo bajo ancho", "Remo bajo cerrado", "Remo bajo unilateral", "Remo con mancuerna biilateral / unilateral", "Remo con barra codo abierto", "Remo con barra codo cerrado", "Pullover", "Remo dorian"],
        "BICEPS / TRICEPS / DELTOIDES": ["Curl biceps con barra", "Curl biceps con mancuerna", "Curl biceps sentado con mancuerna", "Curl bicepspredicador con barra", "Curl biceps predicador con mancuerna", "Curl biceps en polea", "Curl biceps bayessian", "Curl biceps martillo", "Triceps polea alta bilat / unilat", "Triceps trasnuca bilat / unilat", "Press frances", "Fondo en paralela", "Press vertical barra / mancuerna (deltoides)", "Vuelo lateral", "Vuelo frontal", "Vuelo posterior", "Peck deck inverso."]
    };

    // L√≥gica de Instalaci√≥n
    window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
        if (isMobile) {
            document.getElementById('install-profe').style.display = 'block';
        }
    });

    document.getElementById('install-profe').addEventListener('click', async () => {
        if (deferredPrompt) {
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            deferredPrompt = null;
            if (outcome === 'accepted') document.getElementById('install-profe').style.display = 'none';
        }
    });

    function agregarSesion() {
        contadorSesiones++;
        const div = document.createElement('div');
        div.className = 'card sesion';
        div.id = `sesion-${contadorSesiones}`;
        div.innerHTML = `
            <div class="dia-label">D√çA CONFIGURADO</div>
            <div style="display:flex; justify-content:space-between; margin-bottom:15px; align-items:center;">
                <input type="text" placeholder="Ej: Lunes" class="nombre-sesion" style="width:70%; margin:0; font-weight:bold;">
                <button style="background:var(--danger); border:none; color:white; padding:5px 10px; border-radius:5px;" onclick="this.parentElement.parentElement.remove()">X</button>
            </div>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:10px;">
                <div><label>Descanso Set (seg)</label><input type="number" class="descanso-series" value="90"></div>
                <div><label>Descanso Ejerc. (seg)</label><input type="number" class="descanso-ejercicios" value="180"></div>
            </div>
            <div class="ejercicios-container"></div>
            <button class="btn-add-ex" onclick="agregarEjercicio(${contadorSesiones})">+ A√±adir Ejercicio</button>
        `;
        document.getElementById('rutina-container').appendChild(div);
        agregarEjercicio(contadorSesiones);
    }

    function agregarEjercicio(sId) {
        const container = document.querySelector(`#sesion-${sId} .ejercicios-container`);
        const div = document.createElement('div');
        div.className = 'ex-item';
        const gruposHtml = Object.keys(DATA_EJERCICIOS).map(g => `<option value="${g}">${g}</option>`).join('');
        div.innerHTML = `
            <div style="display:grid; grid-template-columns: 1fr; gap: 8px;">
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
                    <div><label>Grupo Muscular</label><select class="ex-grupo" onchange="actualizarEjercicios(this)">${gruposHtml}</select></div>
                    <div><label>Ejercicio</label><select class="ex-nombre"></select></div>
                </div>
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
                    <div><label>Sets</label><input type="number" class="ex-series" value="4"></div>
                    <div><label>Rep (Obj)</label><input type="text" class="ex-reps" placeholder="12,12,10"></div>
                </div>
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
                    <div><label>Kg (Obj)</label><input type="text" class="ex-peso" placeholder="50,55,60"></div>
                    <div><label>Link Video</label><input type="text" class="ex-video" placeholder="YouTube Link"></div>
                </div>
            </div>
            <button onclick="this.parentElement.remove()" style="background:none; color:#da3633; border:none; font-size:0.7rem; cursor:pointer; width:100%; text-align:right; margin-top:5px;">Eliminar Ejercicio</button>
        `;
        container.appendChild(div);
        actualizarEjercicios(div.querySelector('.ex-grupo'));
    }

    function actualizarEjercicios(selectGrupo) {
        const grupo = selectGrupo.value;
        const selectEx = selectGrupo.parentElement.parentElement.parentElement.querySelector('.ex-nombre');
        const ejercicios = DATA_EJERCICIOS[grupo] || [];
        selectEx.innerHTML = ejercicios.map(e => `<option value="${e}">${e}</option>`).join('');
    }

    function generarLink() {
        const nombre = document.getElementById('alumno-nombre').value;
        const semana = document.getElementById('semana-nro').value;
        if(!nombre) return alert("Falta nombre del alumno");
        const rutina = { alumno: nombre, semana: semana, sesiones: {} };
        document.querySelectorAll('.sesion').forEach((s, idx) => {
            const ejercicios = [];
            s.querySelectorAll('.ex-item').forEach(item => {
                ejercicios.push({
                    nombre: item.querySelector('.ex-nombre').value,
                    grupo: item.querySelector('.ex-grupo').value,
                    series: parseInt(item.querySelector('.ex-series').value),
                    reps_obj: item.querySelector('.ex-reps').value,
                    peso_obj: item.querySelector('.ex-peso').value,
                    video: item.querySelector('.ex-video').value
                });
            });
            rutina.sesiones[idx + 1] = {
                nombre: s.querySelector('.nombre-sesion').value || `D√≠a ${idx+1}`,
                descanso_s: parseInt(s.querySelector('.descanso-series').value),
                descanso_e: parseInt(s.querySelector('.descanso-ejercicios').value),
                ejercicios: ejercicios
            };
        });
        const base64 = btoa(unescape(encodeURIComponent(JSON.stringify(rutina))));
        document.getElementById('linkFinal').innerText = base64;
        document.getElementById('resultado').style.display = "block";
        window.scrollTo(0, document.body.scrollHeight);
    }

    function copiarLink() {
        const text = document.getElementById("linkFinal").innerText;
        const tempInput = document.getElementById("temp-copy");
        tempInput.value = text;
        tempInput.select();
        document.execCommand("copy");
        alert("‚úÖ ¬°Copiado!");
    }

    agregarSesion();
</script>
</body>
</html>
