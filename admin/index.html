<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Panel Profe - Control Total</title>
    
  <link rel="manifest" href="manifest-admin.json?v=9">
    <meta name="theme-color" content="#0b0f1a">
    
    <style>
        :root {
            --bg: #0b0f1a; --card: #161b22; --primary: #3b82f6;
            --success: #238636; --danger: #da3633; --text: #f0f6fc;
            --accent: #8b5cf6; 
            --electric-blue: #00d4ff; 
        }
        
        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: var(--bg); color: var(--text); padding: 10px; padding-bottom: 50px; }
        h1 { font-size: 1.4rem; text-align: center; color: var(--primary); margin: 15px 0; }

        .card { background: var(--card); padding: 15px; border-radius: 12px; margin-bottom: 25px; border: 1px solid #30363d; position: relative; }
        
        .sesion { border-top: 6px solid var(--accent); }
        .dia-label { position: absolute; top: -15px; left: 15px; background: var(--accent); color: white; padding: 2px 12px; border-radius: 4px; font-size: 0.7rem; font-weight: bold; }

        label { display: block; font-size: 0.7rem; color: var(--primary); font-weight: bold; margin-bottom: 4px; text-transform: uppercase; }
        input, select { width: 100%; padding: 12px; margin-bottom: 10px; background: #0d1117; border: 1px solid #30363d; color: white; border-radius: 8px; font-size: 1rem; outline: none; }

        .btn-add-day { background: var(--accent); color: white; width: 100%; padding: 15px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; margin-bottom: 15px; }
        .btn-add-ex { background: #3e4c5a; color: #fff; border: none; padding: 12px; border-radius: 8px; cursor: pointer; width: 100%; font-size: 0.9rem; font-weight: bold; }
        .btn-gen { background: var(--primary); color: white; width: 100%; padding: 18px; font-size: 1.1rem; font-weight: bold; border: none; border-radius: 12px; cursor: pointer; margin-top: 10px; }

        .ex-item { border-left: 3px solid var(--primary); padding: 12px; margin-bottom: 12px; background: #1c2128; border-radius: 0 8px 8px 0; }
        .copy-area { background: #000; color: #22c55e; border: 1px solid var(--success); font-family: monospace; padding: 15px; border-radius: 8px; word-break: break-all; font-size: 0.75rem; margin-top: 10px; }
        
/* Estilo para el T√≠tulo Grande */
.title-sign { 
    text-align: center; 
    color: #888; 
    font-size: 1.4rem; /* Tama√±o grande para el t√≠tulo */
    letter-spacing: 3px; 
    margin-top: 40px; 
    font-weight: bold; 
}

/* Estilo para tu Firma Peque√±a */
.footer-sign { 
    text-align: center; 
    color: #444; 
    font-size: 0.8rem; /* Tama√±o original para tu marca */
    letter-spacing: 3px; 
    margin-top: 20px; 
    font-weight: bold; 
    padding-bottom: 100px; 
}

/* Reglas comunes para los enlaces y spans dentro de ambos */
.title-sign a, .footer-sign a {
    text-decoration: none;
}

.title-sign span, .footer-sign span { 
    color: #00d4ff;
    text-shadow: 0 0 8px rgba(0, 212, 255, 0.6);
    transition: 0.3s;
}

.title-sign span:hover, .footer-sign span:hover {
    text-shadow: 0 0 15px rgba(0, 212, 255, 1);
    color: #ffffff;
}

/* Efecto opcional al pasar el mouse o tocar */
.footer-sign span:hover {
    text-shadow: 0 0 15px rgba(0, 212, 255, 1);
    color: #ffffff;
}
        .brand-link { color: var(--electric-blue); text-decoration: none; }

        #temp-copy { position: absolute; left: -9999px; }
/* Ajuste para que el t√≠tulo no se corte en celulares */
@media (max-width: 400px) {
    .title-sign span {
        display: block; /* Fuerza el salto de l√≠nea solo en m√≥viles */
        margin-top: 5px;
    }
}
/* Protector de acceso */
#access-screen {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: var(--bg); z-index: 9999; display: flex;
    flex-direction: column; align-items: center; justify-content: center;
    padding: 20px;
}
    </style>
</head>
<body>
<div id="access-screen">
    <footer class="title-sign" style="margin-bottom: 20px;">
        PANEL PROFE <a><span>LEO RODRIGUEZ</span></a>
    </footer>
    <input type="password" id="admin-pass" placeholder="Ingrese Clave de Acceso" 
           style="max-width: 300px; text-align: center; border: 2px solid var(--primary);">
    <button onclick="verificarAcceso()" class="btn-gen" style="max-width: 300px;">ENTRAR AL PANEL</button>
    <p id="error-msg" style="color: var(--danger); font-size: 0.8rem; margin-top: 10px; display: none;">Clave incorrecta. Intente de nuevo.</p>
</div>

<footer class="title-sign">
    PANEL PROFE <a><span>LEO RODRIGUEZ</span></a>
</footer>

    <div class="card">
        <label>Nombre del Alumno</label><input type="text" id="alumno-nombre" placeholder="Ej: Juan P√©rez">
        <label>Semana #</label><input type="text" id="semana-nro" placeholder="Ej: 1">
    </div>

    <div id="rutina-container"></div>

    <button class="btn-add-day" onclick="agregarSesion()">+ AGREGAR OTRO D√çA</button>
    <button class="btn-gen" onclick="generarLink()">GENERAR C√ìDIGO DE RUTINA</button>

 <div id="resultado" style="display:none;" class="card">
        <div style="text-align:center; padding: 10px 0;">
            <div style="font-size: 3rem; margin-bottom: 10px;">‚úÖ</div>
            <h2 style="color: var(--success); font-size: 1.2rem; margin-bottom: 5px;">¬°RUTINA LISTA!</h2>
            <p style="color: #888; font-size: 0.8rem; margin-bottom: 20px;">El c√≥digo se gener√≥ correctamente para <b><span id="target-alumno"></span></b>.</p>
            
            <label>Vista previa del c√≥digo:</label>
            <div id="linkFinal" class="copy-area" style="height: 60px; overflow-y: auto; opacity: 0.5; border-style: dashed; margin-bottom: 20px;"></div>
            
            <button onclick="enviarWhatsApp(event)" style="background: #232d36; color: white; width:100%; padding:18px; border:1px solid #25D366; border-radius:12px; font-weight:bold; cursor:pointer; font-size: 1rem; margin-top: 10px;">
    üì≤ ENVIAR POR WHATSAPP DIRECTO
</button>
        </div>
        <textarea id="temp-copy" style="position: absolute; left: -9999px;"></textarea>
    </div>

    <footer class="footer-sign">
    DESARROLLADO POR <a href="https://www.linkedin.com/in/nicolas-yabichino/" target="_blank"><span>NICOYABI</span></a>
</footer>

<script>
    let contadorSesiones = 0;

    const DATA_EJERCICIOS = {
        "MOVILIDAD": ["Rotacion de columna", "Movilidad de cadera", "Movilidad de rodilla", "Rotacion de hombros", "Gato malo/bueno"],
        "ABDOMEN / CORE": ["Plancha frontal", "Plancha lateral", "Planchas din√°micas", "Crunch", "Oblicuos", "Bicho muerto", "Bird-dog", "Abs wheel (ruedita)", "Abs sovieticas", "Le√±ador ascendente", "Le√±ador descendente", "Elevacion de piernas"],
        "TREN INF / CUADRICEPS / GEMELOS": ["Sentadilla con barra alta", "Sentadilla con barra baja", "Sentadilla frontal", "Sentadilla en multipower", "Sentadilla hack", "Sentadilla pendular", "Sentadilla goblet", "Sentadilla bulgara (enfoque cuadriceps)", "Prensa bilateral / unilateral", "Sillon cuadriceps bilateral /unilateral", "Estocada hacia adelante", "Subidas al banco (enfoque cuadriceps)", "Gemelos en prensa", "Gemelos en maquina especifica", "Gemelos con mancuernas", "Gemelos con barra"],
        "TREN INF / ISQUIOS / GLUTEOS / ADUCTORES": ["Peso muerto convencional", "Peso muerto rumano", "Peso muerto piernas rigidas", "Peso muerto sumo", "Peso muerto unilateral", "Camilla de isquis bilateral / unilateral", "Aductores en maquina", "Abducciones en maquina", "Patada de gluteo en maquina especifica", "Patada de gluteo en polea", "Hip-trust bilateral / unilateral", "Sentadilla bulgara (enfoque gluteo)", "Subida al banco (enfoque gluteo)", "Abducciones con banda"],
        "PECTORAL": ["Press plano barra / mancuerna / multipower", "Press inclinado barra / mancuenra / multipower", "Press declinado con mancuerna", "Press en polea altura media", "Peck deck", "Apertura con mancuernas", "Flexiones de brazos", "Poleas cruzadas"],
        "DORSALES": ["Dominadas supina", "Dominadas pronacion", "Jalon al pecho supino", "Jalon al pecho prono", "Jalon al pecho agarre cerrado (triangulo)", "Remo bajo ancho", "Remo bajo cerrado", "Remo bajo unilateral", "Remo con mancuerna biilateral / unilateral", "Remo con barra codo abierto", "Remo con barra codo cerrado", "Pullover", "Remo dorian"],
        "BICEPS / TRICEPS / DELTOIDES": ["Curl biceps con barra", "Curl biceps con mancuerna", "Curl biceps sentado con mancuerna", "Curl bicepspredicador con barra", "Curl biceps predicador con mancuerna", "Curl biceps en polea", "Curl biceps bayessian", "Curl biceps martillo", "Triceps polea alta bilat / unilat", "Triceps trasnuca bilat / unilat", "Press frances", "Fondo en paralela", "Press vertical barra / mancuerna (deltoides)", "Vuelo lateral", "Vuelo frontal", "Vuelo posterior", "Peck deck inverso."]
    };

    function agregarSesion() {
        contadorSesiones++;
        const div = document.createElement('div');
        div.className = 'card sesion';
        div.id = `sesion-${contadorSesiones}`;
        div.innerHTML = `
            <div class="dia-label">D√çA CONFIGURADO</div>
            <div style="display:flex; justify-content:space-between; margin-bottom:15px; align-items:center;">
                <input type="text" placeholder="Ej: Lunes" class="nombre-sesion" style="width:70%; margin:0; font-weight:bold;">
                <button style="background:var(--danger); border:none; color:white; padding:5px 10px; border-radius:5px;" onclick="this.parentElement.parentElement.remove()">X</button>
            </div>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:10px;">
                <div><label>Descanso Set (seg)</label><input type="number" class="descanso-series" value="90"></div>
                <div><label>Descanso Ejerc. (seg)</label><input type="number" class="descanso-ejercicios" value="180"></div>
            </div>
            <div class="ejercicios-container"></div>
            <button class="btn-add-ex" onclick="agregarEjercicio(${contadorSesiones})">+ A√±adir Ejercicio</button>
        `;
        document.getElementById('rutina-container').appendChild(div);
        agregarEjercicio(contadorSesiones);
    }

    function agregarEjercicio(sId) {
        const container = document.querySelector(`#sesion-${sId} .ejercicios-container`);
        const div = document.createElement('div');
        div.className = 'ex-item';
        
        const gruposHtml = Object.keys(DATA_EJERCICIOS).map(g => `<option value="${g}">${g}</option>`).join('');
        
        div.innerHTML = `
            <div style="display:grid; grid-template-columns: 1fr; gap: 8px;">
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
                    <div>
                        <label>Grupo Muscular</label>
                        <select class="ex-grupo" onchange="actualizarEjercicios(this)">
                            ${gruposHtml}
                        </select>
                    </div>
                    <div>
                        <label>Ejercicio</label>
                        <select class="ex-nombre"></select>
                    </div>
                </div>
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
                    <div><label>Sets</label><input type="number" class="ex-series" value="4"></div>
                    <div><label>Rep (Obj)</label><input type="text" class="ex-reps" placeholder="Ej: 12,12,10"></div>
                </div>
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
                    <div><label>Kg (Obj)</label><input type="text" class="ex-peso" placeholder="Ej: 50,55,60"></div>
                    <div><label>Link Video</label><input type="text" class="ex-video" placeholder="YouTube Link"></div>
                </div>
            </div>
            <button onclick="this.parentElement.remove()" style="background:none; color:#da3633; border:none; font-size:0.7rem; cursor:pointer; width:100%; text-align:right; margin-top:5px;">Eliminar Ejercicio</button>
        `;
        container.appendChild(div);
        actualizarEjercicios(div.querySelector('.ex-grupo'));
    }

    function actualizarEjercicios(selectGrupo) {
        const grupo = selectGrupo.value;
        const selectEx = selectGrupo.parentElement.parentElement.parentElement.querySelector('.ex-nombre');
        const ejercicios = DATA_EJERCICIOS[grupo] || [];
        selectEx.innerHTML = ejercicios.map(e => `<option value="${e}">${e}</option>`).join('');
    }

function generarLink() {
        const nombre = document.getElementById('alumno-nombre').value;
        const semana = document.getElementById('semana-nro').value;
        if(!nombre) return alert("Falta nombre del alumno");
        
        const rutina = { alumno: nombre, semana: semana, sesiones: {} };
        document.querySelectorAll('.sesion').forEach((s, idx) => {
            const ejercicios = [];
            s.querySelectorAll('.ex-item').forEach(item => {
                ejercicios.push({
                    nombre: item.querySelector('.ex-nombre').value,
                    grupo: item.querySelector('.ex-grupo').value,
                    series: parseInt(item.querySelector('.ex-series').value),
                    reps_obj: item.querySelector('.ex-reps').value,
                    peso_obj: item.querySelector('.ex-peso').value,
                    video: item.querySelector('.ex-video').value
                });
            });
            rutina.sesiones[idx + 1] = {
                nombre: s.querySelector('.nombre-sesion').value || `D√≠a ${idx+1}`,
                descanso_s: parseInt(s.querySelector('.descanso-series').value),
                descanso_e: parseInt(s.querySelector('.descanso-ejercicios').value),
                ejercicios: ejercicios
            };
        });

        // Generamos el base64
        const base64 = btoa(unescape(encodeURIComponent(JSON.stringify(rutina))));
    // --- CAMBIOS VISUALES AQU√ç ---
        document.getElementById('target-alumno').innerText = nombre.toUpperCase();
        document.getElementById('linkFinal').innerText = base64;
        document.getElementById('resultado').style.display = "block";
        
        // Guardamos el base64 en una variable global temporal para WhatsApp
        window.currentBase64 = base64;
        window.currentAlumno = nombre;

        // Scroll suave hacia el resultado
        window.scrollTo({
            top: document.getElementById('resultado').offsetTop - 20,
            behavior: 'smooth'
        });
    }

function copiarLink(event) { // <--- Agregamos 'event' aqu√≠
    const text = document.getElementById("linkFinal").innerText;
    const tempInput = document.getElementById("temp-copy");
    tempInput.value = text;
    tempInput.select();
    document.execCommand("copy");
    
    // Feedback visual en el bot√≥n
    const btn = event.currentTarget;
    const originalText = btn.innerHTML;
    btn.style.background = "var(--success)";
    btn.innerHTML = "‚úÖ ¬°COPIADO CON √âXITO!";
    
    setTimeout(() => {
        btn.style.background = "var(--primary)";
        btn.innerHTML = originalText;
    }, 2000);
}

    // √öNICA ADICI√ìN EN SCRIPT: REGISTRO DEL SERVICE WORKER
if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
        // Al estar en la misma carpeta, la ruta es directa
        navigator.serviceWorker.register('./sw-admin.js')
            .then(reg => console.log('Admin SW OK'))
            .catch(err => console.log('Error:', err));
    });
}

    agregarSesion();
function verificarAcceso(){var _0x5071=['UmlvMjAyNg==','admin-pass','value','error-msg','block','none','admin_auth','true','display','style','getItem','setItem'];const _0x4704=document['getElementById'](_0x5071[1])[_0x5071[2]];const _0x1a2b=btoa(unescape(encodeURIComponent(_0x4704)));if(_0x1a2b===_0x5071[0]){document['getElementById']('access-screen')[_0x5071[9]][_0x5071[8]]=_0x5071[5];localStorage[_0x5071[11]](_0x5071[6],_0x5071[7]);}else{document['getElementById'](_0x5071[3])[_0x5071[9]][_0x5071[8]]=_0x5071[4];document['getElementById'](_0x5071[1])[_0x5071[2]]='';}}

// Al cargar la p√°gina, chequeamos el localStorage
window.addEventListener('DOMContentLoaded', () => {
    if(localStorage.getItem('admin_auth') === 'true') {
        document.getElementById('access-screen').style.display = 'none';
    }
});
    // Permite entrar al panel apretando la tecla "Enter"
document.getElementById('admin-pass').addEventListener('keypress', function (e) {
    if (e.key === 'Enter') {
        verificarAcceso();
    }
});
    function enviarWhatsApp(event) {
    if (!window.currentBase64) return alert("Primero genera la rutina");

    // REEMPLAZA ESTO con la URL real donde el alumno ve su rutina
    // Ejemplo: "https://leoprofe-entrenamientos.netlify.app/"
    const urlAppAlumno = "https://nicoyabichino.github.io/LeoWorkApp/index.html"; 

    // Construimos el link con el par√°metro ?data=
    const linkFinal = `${urlAppAlumno}?data=${encodeURIComponent(window.currentBase64)}`;
    
    // Mensaje personalizado
    const mensaje = `üí™ *¬°Hola ${window.currentAlumno}!* Ac√° te paso tu rutina de la semana actualizada. \n\nPara cargarla, solo hac√© clic en este link:\n\n${linkFinal}`;
    
    // Abrir WhatsApp
    const urlWA = `https://api.whatsapp.com/send?text=${encodeURIComponent(mensaje)}`;
    window.open(urlWA, '_blank');

    // Feedback visual en el bot√≥n
    const btn = event.currentTarget;
    btn.innerHTML = "‚úÖ ENVIADO A WHATSAPP";
    setTimeout(() => { btn.innerHTML = "üì≤ ENVIAR POR WHATSAPP DIRECTO"; }, 2000);
}
</script>
</body>
</html>






